<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Huanger Films – Calendar</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    header { background:#111; color:#fff; padding:15px; text-align:center; font-size:24px; }
    .view-switch { display:flex; justify-content:center; gap:12px; margin:15px; }
    button { padding:10px 16px; cursor:pointer; }
    /* MONTH VIEW */
    #monthView { display:none; padding:20px; }
    .month-header { display:flex; justify-content:space-between; align-items:center; font-size:20px; margin-bottom:15px; }
    .month-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:5px; }
    .day-cell { border:1px solid #ccc; padding:10px; min-height:80px; position:relative; cursor:pointer; }
    .day-num { font-weight:bold; }
    .booked { background:#ffb3b3; }

    /* WEEK VIEW */
    #weekView { padding:20px; }
    .week-header { display:flex; justify-content:space-between; align-items:center; font-size:20px; margin-bottom:15px; }
    .week-grid { display:grid; grid-template-columns:repeat(8,1fr); border:1px solid #000; }
    .week-grid div { border:1px solid #ccc; padding:6px; font-size:12px; }
    .hour-box { cursor:pointer; min-height:38px; }
    .hour-box.available { background:#d2ffd2; }
    .hour-box.booked { background:#ff7a7a; }
  </style>
</head>
<body>
<header>
  Huanger Films – Booking Calendar
  <nav style="margin-top:10px; display:flex; justify-content:center; gap:15px; font-size:16px;">
    <a href="index.html" style="color:white;">Home</a>
    <a href="videos.html" style="color:white;">Videos</a>
    <a href="photos.html" style="color:white;">Photos</a>
    <a href="merch.html" style="color:white;">Merch</a>
    <a href="calendar.html" style="color:white; font-weight:bold;">Calendar</a>
  </nav>
</header>

<div class="view-switch">
  <button onclick="showMonth()">Month View</button>
  <button onclick="showWeek()">Week View</button>
</div>

<!-- MONTH VIEW -->
<div id="monthView">
  <div class="month-header">
    <button onclick="changeMonth(-1)">◀</button>
    <div id="monthLabel"></div>
    <button onclick="changeMonth(1)">▶</button>
  </div>
  <div class="month-grid" id="monthGrid"></div>
</div>

<!-- WEEK VIEW -->
<div id="weekView">
  <div class="week-header">
    <button onclick="changeWeek(-1)">◀</button>
    <div id="weekLabel"></div>
    <button onclick="changeWeek(1)">▶</button>
  </div>
  <div class="week-grid" id="weekGrid"></div>
</div>

<script>
// ==========================
//   GLOBAL DATA STORAGE
// ==========================
let bookings = JSON.parse(localStorage.getItem("hfBookings") || "{}");
function saveBookings() { localStorage.setItem("hfBookings", JSON.stringify(bookings)); }

// ==========================
//   VIEW SWITCHING
// ==========================
function showMonth(){ document.getElementById("monthView").style.display="block"; document.getElementById("weekView").style.display="none"; renderMonth(); }
function showWeek(){ document.getElementById("monthView").style.display="none"; document.getElementById("weekView").style.display="block"; renderWeek(); }

// ==========================
//   MONTH VIEW
// ==========================
let currentMonth=new Date();

function changeMonth(dir){ currentMonth.setMonth(currentMonth.getMonth()+dir); renderMonth(); }

function renderMonth(){
  const year=currentMonth.getFullYear();
  const month=currentMonth.getMonth();
  const first=new Date(year,month,1);
  const days=new Date(year,month+1,0).getDate();

  document.getElementById("monthLabel").textContent=
    currentMonth.toLocaleString("default",{month:"long"})+" "+year;

  const grid=document.getElementById("monthGrid");
  grid.innerHTML="";

  for(let i=0;i<first.getDay();i++){ grid.innerHTML+=`<div></div>`; }

  for(let d=1; d<=days; d++){
    const key=`${year}-${month+1}-${d}`;
    const bookedDay = bookings[key] && Object.values(bookings[key]).includes(true);
    grid.innerHTML += `
      <div class="day-cell ${bookedDay?"booked":""}" onclick="openDay('${key}')">
        <div class="day-num">${d}</div>
      </div>`;
  }
}

function openDay(key){ alert("Switch to week view to book by the hour."); }

// ==========================
//   WEEK VIEW
// ==========================
let currentWeek=new Date();

function changeWeek(dir){ currentWeek.setDate(currentWeek.getDate()+dir*7); renderWeek(); }

function getWeekDates(date){
  const start=new Date(date);
  start.setDate(start.getDate()-start.getDay());
  const days=[];
  for(let i=0;i<7;i++){
    const d=new Date(start);
    d.setDate(start.getDate()+i);
    days.push(d);
  }
  return days;
}

function renderWeek(){
  const days=getWeekDates(currentWeek);
  const labelDays=days[0].toLocaleDateString()+" – "+days[6].toLocaleDateString();
  document.getElementById("weekLabel").textContent=labelDays;

  const grid=document.getElementById("weekGrid");
  grid.innerHTML="";

  grid.innerHTML += `<div></div>`;
  days.forEach(d=>grid.innerHTML+=`<div>${d.toLocaleDateString()}</div>`);

  for(let h=0; h<24; h++){
    grid.innerHTML+=`<div><b>${h}:00</b></div>`;
    days.forEach(d=>{
      const key=`${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;
      if(!bookings[key]) bookings[key]={};
      const hrKey=h;
      const booked=bookings[key][hrKey]===true;
      grid.innerHTML+=`
        <div class="hour-box ${booked?"booked":"available"}" onclick="attemptBooking('${key}', ${hrKey})">
          ${booked?"Booked":"Available"}
        </div>`;
    });
  }
}

// ==========================
//   PAYMENT + BOOKING
// ==========================
function attemptBooking(key, hour){
  if(bookings[key] && bookings[key][hour]===true){ alert("Already booked."); return; }
  const price=prompt("Set your price for this hour (USD):", "50");
  if(!price) return;

  // Simulated checkout link — replace with Stripe/PayPal
  const proceed=confirm(`Pay $${price}?`);
  if(!proceed) return;

  // After payment success
  bookings[key][hour]=true;
  saveBookings();
  renderWeek();
  renderMonth();
}

// Start in week view
showWeek();
</script>
</body>
</html>
